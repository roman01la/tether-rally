```
┌─────────────────────────────────────────────────────────────────────────────────────────┐
│                           ARRMA STABILITY SYSTEMS ARCHITECTURE                          │
└─────────────────────────────────────────────────────────────────────────────────────────┘

                                    ┌─────────────┐
                                    │   SENSORS   │
                                    └──────┬──────┘
                                           │
          ┌────────────────────────────────┼──────────────────────────────┐
          │                                │                              │
          ▼                                ▼                              ▼
   ┌─────────────┐                 ┌─────────────┐                 ┌─────────────┐
   │  BNO055 IMU │                 │ Hall Sensor │                 │     GPS     │
   │  (20 Hz)    │                 │  (Wheel)    │                 │             │
   └──────┬──────┘                 └──────┬──────┘                 └──────┬──────┘
          │                               │                               │
          │ • Yaw rate (°/s)              │ • Wheel speed (km/h)          │ • Ground speed
          │ • Forward accel (m/s²)        │ • Distance (m)                │ • Position
          │ • Lateral accel (m/s²)        │                               │
          │ • Pitch (°)                   │                               │
          │ • Heading (°)                 │                               │
          │                               │                               │
          └────────────────┬──────────────┴─────────────────┬─────────────┘
                           │                                │
                           ▼                                ▼
                  ┌─────────────────┐              ┌─────────────────┐
                  │ SPEED FUSION    │              │    DIRECTION    │
                  │ wheel + IMU +   │◄────────────►│    ESTIMATOR    │
                  │ GPS drift corr  │              │ IMU + yaw-steer │
                  └────────┬────────┘              └────────┬────────┘
                           │                                │
                           │ fused_speed (km/h)             │ direction (fwd/bwd/stopped)
                           │                                │ signed_speed (km/h)
                           ▼                                │
                  ┌─────────────────┐                       │
                  │    SURFACE      │                       │
                  │   ADAPTATION    │                       │
                  │ lateral vs      │                       │
                  │ expected grip   │                       │
                  └────────┬────────┘                       │
                           │                                │
                           │ grip_multiplier                │
                           │                                │
          ┌────────────────┴────────────────────────────────┘
          │
          ▼
┌─────────────────────────────────────────────────────────────────────────────────────────┐
│                              CONTROLLER CHAIN (in order)                                │
│                                                                                         │
│  ┌─────────────┐   ┌─────────────┐   ┌─────────────┐   ┌─────────────┐   ┌───────────┐  │
│  │  STEERING   │   │   HILL      │   │  TRACTION   │   │  YAW RATE   │   │   SLIP    │  │
│  │   SHAPER    │   │   HOLD      │   │   CONTROL   │   │ CONTROLLER  │   │  WATCHDOG │  │
│  │             │   │             │   │   (TC)      │   │   (ESC)     │   │           │  │
│  └──────┬──────┘   └──────┬──────┘   └──────┬──────┘   └──────┬──────┘   └─────┬─────┘  │
│         │                 │                 │                 │                │        │
│         │                 │                 │                 │                │        │
│  ┌──────┴──────┐   ┌──────┴──────┐   ┌──────┴──────┐   ┌──────┴──────┐   ┌─────┴─────┐  │
│  │ Modifies:   │   │ Modifies:   │   │ Modifies:   │   │ Modifies:   │   │ Modifies: │  │
│  │ STEERING    │   │ THROTTLE    │   │ THROTTLE    │   │ THROTTLE    │   │ THROTTLE  │  │
│  │             │   │ (hold)      │   │ (×0.5-1.0)  │   │ (×0.5-1.0)  │   │ (×0.5-1.0)│  │
│  └─────────────┘   └─────────────┘   └─────────────┘   └─────────────┘   └───────────┘  │
│                                                                                         │
└─────────────────────────────────────────────────────────────────────────────────────────┘
                           │
                           ▼
┌─────────────────────────────────────────────────────────────────────────────────────────┐
│                              BRAKING SYSTEMS                                            │
│                                                                                         │
│  ┌─────────────────────────────┐              ┌─────────────────────────────┐           │
│  │           ABS               │              │       COAST CONTROL         │           │
│  │  Anti-lock Braking System   │              │   Smooth throttle release   │           │
│  │                             │              │                             │           │
│  │  Modifies: THROTTLE (brake) │              │  Modifies: THROTTLE         │           │
│  │  (pulse 60%/20%)            │◄─────────────│  (brief positive inject)    │           │
│  └─────────────────────────────┘              └─────────────────────────────┘           │
│                                                                                         │
└─────────────────────────────────────────────────────────────────────────────────────────┘
                           │
                           ▼
                  ┌─────────────────┐
                  │    THROTTLE     │
                  │    PIPELINE     │
                  │   FINAL OUTPUT  │
                  └────────┬────────┘
                           │
                           ▼
                  ┌─────────────────┐
                  │     ESP32       │
                  │   (actuators)   │
                  └─────────────────┘
```
